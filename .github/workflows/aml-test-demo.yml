name: AML Test Demo
on: [push]
jobs:
  Explore-AML-with-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Setup python
        uses: actions/setup-python@v2
        with: 
          python-version: "3.8"
      - name: Install azureml-core on a GitHub hosted server
        run: pip install azureml-core
      - name: Install az ml
        run: az extension add -n ml -y
      - name: Log in to Azure
        uses: azure/login@v1
        with:
          creds: ${{secrets.AZ_AE_CREDS}}
      - name: Check if az ml folder works
        run: az ml folder
      - name: Verify az ml installation and see available subcommands
        run: az ml -h
      - name: Attach to workspace
        run: az ml folder attach -w pradjoshi-aml-ws -g pradjoshi-aml-rg
      - name: Submit a test to AML
        run: python workflows/job.py
      - run: echo "üçè This job's status is ${{ job.status }}."